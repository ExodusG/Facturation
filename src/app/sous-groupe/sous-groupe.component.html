<table #innerTables mat-table [dataSource]="data2" multiTemplateDataRows>
  <ng-container matColumnDef="designation">
    <td mat-cell *matCellDef="let sousGroupe">
      <div class="designation-group">
        <button mat-icon-button (click)="toggleCollapse(sousGroupe)">
          <mat-icon>{{!collapsedElements.includes(sousGroupe) ? "expand_less" : "expand_more"}}</mat-icon>
        </button>
        <p class="designation-text"><strong>{{sousGroupe.designation}}</strong></p>
      </div>
    </td>
  </ng-container>

  <ng-container matColumnDef="qte">
    <td mat-cell *matCellDef="let groupe">  </td>
  </ng-container>
  <ng-container matColumnDef="unite">
    <td mat-cell *matCellDef="let groupe">  </td>
  </ng-container>
  <ng-container matColumnDef="pu">
    <td mat-cell *matCellDef="let groupe">  </td>
  </ng-container>

  <ng-container matColumnDef="total">
    <td mat-cell *matCellDef="let sousGroupe">
      <strong> {{sousGroupe.total | number:'1.2-3'}} </strong>
    </td>
  </ng-container>

  <ng-container matColumnDef="remove">
    <td mat-cell *matCellDef="let sousgroupe">
      <button mat-button (click)="delete(sousgroupe)" >DELETE ROW</button>
    </td>

  </ng-container>
  <ng-container matColumnDef="add">
    <th mat-header-cell *matHeaderCellDef> <strong>Add</strong> </th>
    <td mat-cell *matCellDef="let sousgroupe">
      <button mat-button (click)="showElement()">Add</button>
      <div>
        <app-add-button [showMe]="show" (addType)="add($event,sousgroupe)"> </app-add-button>
      </div>
    </td>

  </ng-container>
  <ng-container matColumnDef="groupes">
    <td mat-cell *matCellDef="let sousgroupe" [attr.colspan]="displayedColumns.length">

        <app-sous-groupe [sousGroupes]="sousgroupe.sousGroupes" (sousGroupe)="deleteSousGroupe($event,sousgroupe)" ></app-sous-groupe>

    </td>

  </ng-container>
  <ng-container matColumnDef="lignes">
    <td mat-cell *matCellDef="let sousgroupe" [attr.colspan]="displayedColumns.length">
      <div class="groupeChiffrage-detail" [@ligneExpand]="!collapsedElements.includes(sousgroupe) ? 'expanded' : 'collapsed'">
        <app-ligne [lignes]="sousgroupe.lignes" (ligne)="deleteLigne($event,sousgroupe)"></app-ligne>
      </div>
    </td>

  </ng-container>

  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  <tr mat-row *matRowDef="let sousGroupe; columns: ['groupes']"
      [class.hidden]="sousGroupe.lignes.length === 0 || collapsedElements.includes(sousGroupe)"
      class="groupeChiffrage-row"></tr>
  <tr mat-row *matRowDef="let sousGroupe; columns: ['lignes']"
      [class.hidden]="sousGroupe.lignes.length === 0 || collapsedElements.includes(sousGroupe)"
      class="groupeChiffrage-row"></tr>
</table>
